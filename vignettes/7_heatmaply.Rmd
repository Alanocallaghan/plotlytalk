---
title: "7. heatmaply"
output:
  rmarkdown::html_vignette:
    fig_caption: yes
    self_contained: yes
    toc: true
    fig_width: 10
    fig_height: 6
    depth: 3  # upto three depths of headings (specified by #, ## and ###)  

vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, echo = FALSE}
suppressPackageStartupMessages(library("SummarizedExperiment"))
suppressPackageStartupMessages(library("plotlytalk"))
```

```{r, fig.caption = "Correlation heatmap"}

gene_signature <- c("ALDOB",
    "ENO1",
    "GALM",
    "GAPDH",
    "HK2",
    "HK3",
    "LDHA",
    "LDHB",
    "PKLR")
raw_mat <- assay(GBMdata)
raw_median_mat <- apply(raw_mat, 1, function(row) {
    row - median(row)
})
heatmaply_cor(cor(t(raw_median_mat[, gene_signature])),
    showticklabels = c(FALSE, FALSE))
```

```{r}
heatmaply(raw_median_mat[, gene_signature],
    showticklabels = c(TRUE, FALSE))
```
